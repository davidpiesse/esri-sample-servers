<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="UTF-8">
    <title>Esri Sample Server List by davidpiesse</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css"
          media="screen">
</head>
<body>
<section class="page-header">
    <h1 class="project-name">ESRI Sample Servers</h1>
    <h2 class="project-tagline">A list of ESRI sample servers and associated services</h2>
    <a href="https://github.com/davidpiesse/esri-sample-servers" class="btn">View on GitHub</a>
    <a href="https://github.com/davidpiesse/esri-sample-servers/zipball/master" class="btn">Download .zip</a>
    <a href="https://github.com/davidpiesse/esri-sample-servers/tarball/master" class="btn">Download .tar.gz</a>
</section>

<section class="main-content">
    <h3>
        <a id="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages" aria-hidden="true"><span
                aria-hidden="true" class="octicon octicon-link"></span></a>ESRI Sample Server Explorer</h3>

    <p>
        Below is a tree view with dynamic loading of information for services
    </p>
    <div id="app">
        {{message}}
        <div v-for="server in servers">
            {{server.url}}
        </div>

    </div>

    <h3>
        <a id="authors-and-contributors" class="anchor" href="#authors-and-contributors" aria-hidden="true"><span
                aria-hidden="true" class="octicon octicon-link"></span></a>Authors and Contributors</h3>

    <p>
        <a href="https://github.com/davidpiesse" class="user-mention">@davidpiesse</a>
    </p>
    <h3>
        <a id="support-or-contact" class="anchor" href="#support-or-contact" aria-hidden="true">
            <span aria-hidden="true"  class="octicon octicon-link"></span></a>Support or Contact</h3>
    <p>
        Need help!? I am on Twitter <a href="https://twitter.com/mapdev">@mapdev</a>
    </p>
    <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/davidpiesse/esri-sample-servers">Esri Sample Server
            List</a> is maintained by <a href="https://github.com/davidpiesse">davidpiesse</a>.</span>
        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a
                href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a
                href="https://twitter.com/jasonlong">Jason Long</a>.</span>
    </footer>
</section>


<script src="//code.jquery.com/jquery-2.2.4.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/vue/1.0.24/vue.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/vue-resource/0.7.2/vue-resource.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/vue-router/0.7.13/vue-router.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js"></script>
<!--<script src="data/servers.json"></script>-->
<script>
    //do all stuff vue etc.
    //setup the page
    function setup() {
        Vue.http.headers.common['Access-Control-Allow-Origin'] = 'http://xxx.xxx.xxx.xxx:94'
        Vue.http.headers.common['Access-Control-Request-Method'] = '*'
        var vue = new Vue({
            el: '#app',
            ready: function () {
                getServerList(this);
            },
            data: {
                message: 'Hello Vue.js!',
                servers: []
            }
        })
    }

    //get the list of servers
    function getServerList(vue) {
        vue.$http({url: 'data/servers.json', method: 'GET'}).then(function (response) {
            vue.servers = response.data;
            iterateServerList(this);
        }, function (response) {
            swal('Error getting server list', "Couldn't retrieve the list of URL's", 'error');
        });
    }

    //for each server url get the servers info and save it back to the server info
    function iterateServerList(vue) {
        //get one
        var svr = vue.servers[0];
        getServerInfo(vue,svr);
    }

    //get a servers JSON details
    function getServerInfo(vue,server) {
        console.log(server);
//        vue.$http({url: 'http://cors.io/?u='+ server.url + '?f=json', method: 'GET'}).then(function (response) {
        vue.$http({url: 'http://cors.io/?u=https://sampleserver3.arcgisonline.com/ArcGIS/rest/services/?f=json', method: 'GET'}).then(function (response) {
            swal('Got Server','success','success');
            console.log(response.data);
        }, function (response) {
            swal('Error getting server info', "Couldn't retrieve the data", 'error');
        });
    }

    //get a Single Service Info
    function getServiceInfo(service) {

    }

    //get a Folders child service
    function getFolderServices(folder) {

    }

    //build the TreeView of data
    function buildTree() {

    }

    setup();
</script>
</body>
</html>
